
训练：

# 设置环境变量
$env:PYTHONPATH = "E:\Waveformer-main"
$env:PYTHONWARNINGS = "ignore"
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
# 运行训练
python src/training/train.py experiments/custom_dataset_config --use_cuda

结果：
	train_loss	test_loss	train_signal_noise_ratio	test_signal_noise_ratio	train_scale_invariant_signal_noise_ratio	test_scale_invariant_signal_noise_ratio
0	-0.537157523	-0.581241179	-6.567628867	-6.143405722	-0.330138724	0.25273609756678345
1	-0.612100193	-0.589099617	-6.535716201	-6.146377706	0.11073824970937955	0.30142957040667534
2	-0.618785639	-0.583143828	-6.532972218	-6.147640876	0.16254059325059256	0.2380117627605796
3	-0.623157542	-0.586795417	-6.532465241	-6.144257177	0.20052663296406	0.2706095814332366
4	-0.627046033	-0.59487817	-6.532168483	-6.13829346	0.23669253806258397	0.35901363606750963
5	-0.630160142	-0.598026072	-6.53187358	-6.13804281	0.2655411968521153	0.38319260367751123
6	-0.632717541	-0.5988151	-6.530569416	-6.139126779	0.29192639578540497	0.38996475702524186
7	-0.635476415	-0.596266386	-6.532498591	-6.144434312	0.3155419664627407	0.3556066616177559
8	-0.637714367	-0.59557048	-6.531481741	-6.146613841	0.33841358591193954	0.35303493358194826
9	-0.640334305	-0.59555062	-6.531571318	-6.143534352	0.364248953760198	0.3516561763398349
10	-0.642936962	-0.594237301	-6.531527986	-6.13754965	0.3898373358610707	0.34591060607135293
11	-0.645645818	-0.601918136	-6.531422153	-6.137817844	0.41633509637440247	0.4200886337310076
12	-0.648128785	-0.599150986	-6.531360144	-6.145033022	0.44034121294425177	0.3858355246782303
13	-0.650363885	-0.593449271	-6.531475587	-6.13830886	0.4636665527555199	0.3315114937722683
14	-0.653028322	-0.594630821	-6.529888436	-6.133620804	0.4906801499240721	0.34519222915917636
15	-0.655428635	-0.592422273	-6.53164833	-6.138642108	0.5129716308832168	0.32205651842057703
16	-0.6582009	-0.599762547	-6.530939228	-6.140005416	0.5408876700321212	0.3936709687411785
17	-0.660496724	-0.597436709	-6.531690654	-6.140338483	0.5635289489188697	0.37460220723599197
18	-0.663087172	-0.594433422	-6.530904135	-6.132832909	0.5904133969720142	0.34642069241404533
19	-0.66553682	-0.591124402	-6.530220554	-6.138168931	0.6149371116734886	0.31136137963831423
20	-0.667789808	-0.597473891	-6.530567596	-6.146053315	0.636285376564685	0.36930208139121534
21	-0.670280447	-0.590006782	-6.529692837	-6.13523521	0.6625976092138328	0.3022488796263933
22	-0.672859895	-0.587991976	-6.531197297	-6.147469336	0.6874520745489591	0.2783617654228583
23	-0.675210778	-0.584109484	-6.532189839	-6.138087629	0.7101433939116386	0.24183250905573367
24	-0.677437333	-0.585895032	-6.531734888	-6.14000569	0.7328592140830277	0.25484901075065136
25	-0.680105333	-0.590082769	-6.531194259	-6.134998236	0.75975648956066	0.3034298756867647
26	-0.682279586	-0.590105821	-6.530034047	-6.142539889	0.7826960199842928	0.29701418239623306
27	-0.684919141	-0.581539509	-6.531362041	-6.136557864	0.8071028297630449	0.21350400911085307
28	-0.687235975	-0.592126771	-6.530225779	-6.133220755	0.8319607264889715	0.32483555626869204
29	-0.688902689	-0.573074096	-6.531252608	-6.130842517	0.8477966330020533	0.1338680269420147
30	-0.691404234	-0.587069122	-6.531133804	-6.144063079	0.87227727467694	0.257560398042202
31	-0.69402314	-0.588384255	-6.530147832	-6.148656649	0.8987446983090602	0.27137290927767754
32	-0.695815454	-0.589544361	-6.530762929	-6.146231742	0.9168893595480981	0.2856727416887879
33	-0.698234318	-0.589549749	-6.5312703	-6.132778205	0.9407968846605625	0.30092820977419615
34	-0.70018592	-0.594841658	-6.530672031	-6.143123552	0.960228988059098	0.3403381827175617
35	-0.701564039	-0.586760211	-6.528960957	-6.139283005	0.9759332131134967	0.2623815790079534
36	-0.703999067	-0.582356888	-6.530634971	-6.144575494	0.9986061372622227	0.2213443208457902
37	-0.706492064	-0.57770064	-6.531467589	-6.129113303	1.023179051580249	0.18452772448211907
38	-0.708501164	-0.582242313	-6.531774109	-6.14372837	1.0428221667593345	0.22016765205562114
39	-0.710166724	-0.585548855	-6.53006253	-6.142499335	1.0611520723919694	0.2557719865739346
40	-0.712787164	-0.591763318	-6.531024314	-6.143488874	1.0866584418076402	0.3160514349974692
41	-0.714014869	-0.581865152	-6.529571388	-6.135223318	1.0992378181383635	0.2188665260374546
42	-0.715949869	-0.581884938	-6.530164314	-6.137047698	1.1185154633522034	0.21762921223044396
43	-0.717856826	-0.573875506	-6.529799647	-6.142312432	1.138598450228541	0.1308736407980323
44	-0.720029455	-0.566032663	-6.530326978	-6.145899645	1.159698406795164	0.05518299153447151
45	-0.722132317	-0.573521173	-6.532460692	-6.142965623	1.1785738844832057	0.13076668944954872
46	-0.723815088	-0.574133002	-6.528973118	-6.145238947	1.1984430141828333	0.13145748990774156
47	-0.725504247	-0.578086892	-6.530080104	-6.138202848	1.2140021193998556	0.18133509566634892
48	-0.727147735	-0.57480702	-6.528929989	-6.141841722	1.2323077845001904	0.14795275439321995
49	-0.729343075	-0.570744585	-6.530852189	-6.136234868	1.251910508932018	0.11142850109189749
50	-0.731051701	-0.56702959	-6.53119522	-6.13926959	1.2679681129334495	0.07054203175008297
51	-0.732981437	-0.568299995	-6.530361087	-6.14177059	1.288502320294641	0.0807924203723669
52	-0.734542215	-0.567035603	-6.530947753	-6.134055263	1.3044224165969838	0.07107727202773094
53	-0.736063164	-0.565254006	-6.529744986	-6.14393905	1.3206021767377543	0.04662788616120815
54	-0.738010549	-0.573936955	-6.530570128	-6.153034394	1.3385683930910552	0.12750999975949526
55	-0.738855262	-0.547884619	-6.530669314	-6.136495745	1.3472619076909809	-0.124346563
56	-0.741024757	-0.566936946	-6.530514788	-6.13894211	1.3695923540888355	0.06711183908581733
57	-0.761818295	-0.564098342	-6.529475621	-6.138228557	1.573004619491566	0.02926577616855502
58	-0.767954802	-0.559824909	-6.529703054	-6.144834124	1.6290753220958636	-0.01817162
59	-0.770537693	-0.561480066	-6.530858303	-6.13670614	1.651926363337071	0.0014816246330738067
60	-0.772553174	-0.553608968	-6.52840266	-6.144862965	1.673021377060252	-0.088053245
61	-0.774327883	-0.556937952	-6.530397792	-6.145099465	1.6887241595826732	-0.054278642
62	-0.775624513	-0.556439457	-6.529912596	-6.145636642	1.701489860139663	-0.057075241
63	-0.777911419	-0.555248265	-6.52865032	-6.130911085	1.7255092035930915	-0.0541892
64	-0.778853951	-0.55470058	-6.530106175	-6.146122796	1.7335146224452804	-0.073603236
65	-0.779370171	-0.554227307	-6.528323573	-6.128972871	1.739737205408335	-0.064373356
66	-0.780185619	-0.554973837	-6.528865017	-6.134273576	1.7471008301939195	-0.062024086
67	-0.780842557	-0.554355857	-6.529832148	-6.142703626	1.7531973861546644	-0.077967993



/////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////
9.7优化之后的训练：
 python src/training/train.py experiments/optimized_config

结果：
 	train_loss	test_loss	train_signal_noise_ratio	test_signal_noise_ratio	train_scale_invariant_signal_noise_ratio	test_scale_invariant_signal_noise_ratio	
0	-0.148407168	-0.471410142	-6.761629309	-6.199159363	-2.472486487	-0.343791493	
1	-0.54489927	-0.545526984	-6.569089036	-6.165158156	-0.271609703	0.034727275751531124	
2	-0.592416091	-0.568796697	-6.54315745	-6.153644656	-0.006801936	0.14857449742406606	
3	-0.608271104	-0.580644876	-6.535387564	-6.145717035	0.08362254727487452	0.2222428724691272	
4	-0.614710379	-0.585286421	-6.533201155	-6.138897569	0.12352045726672901	0.26853324215859176	
5	-0.617561237	-0.586519287	-6.531957059	-6.138390475	0.1430666183973352	0.271253729917109	
6	-0.619238783	-0.58646746	-6.531949466	-6.145432269	0.15556894129382756	0.2625935900956392	
7	-0.620564657	-0.58948711	-6.531672507	-6.138649428	0.166654545331432	0.29495513029396536	
8	-0.622097658	-0.584130427	-6.529208269	-6.133829325	0.18151467534416976	0.24206506846100093	
9	-0.623450998	-0.586548147	-6.531511345	-6.13822256	0.19059857562938706	0.2595392660573125	



///////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////
9.8优化之后的训练：

改动：
数据预处理：src/training/folder_jams_dataset.py 增加归一化，幅度限制到约 [-0.7, 0.7]，并静默 Scaper 裁剪告警
训练日志：src/training/train.py 增加 mixed/output/gt 的范围、能量、形状等检查
指标导入：src/training/train.py 的 torchmetrics 导入做了向后兼容（优先 torchmetrics.audio.snr，否则回退 functional 并静默 FutureWarning）

训练指令：
$env:PYTHONPATH="E:\Waveformer-main"
python src/training/train.py experiments/optimized_config --use_cuda --gpu_ids 0

结果：
	train_loss	test_loss	train_signal_noise_ratio	test_signal_noise_ratio	train_scale_invariant_signal_noise_ratio	test_scale_invariant_signal_noise_ratio
0	-0.150976978	-0.468538833	-6.760148434	-6.200294753	-2.460116276	-0.362286096
1	-0.544837388	-0.547484298	-6.568636153	-6.163960313	-0.276304454	0.04351960238814354
2	-0.591778076	-0.568223631	-6.543124857	-6.153713659	-0.013475429	0.14346476273983716
3	-0.60761257	-0.580268113	-6.535557923	-6.145942201	0.07857046369592038	0.22050176632404328
4	-0.614340798	-0.58450128	-6.533247619	-6.138762726	0.1202428301880369	0.2594684244170785
5	-0.617259748	-0.585272579	-6.531840436	-6.138202289	0.13900208974995962	0.25709316408634186
6	-0.619049876	-0.586937061	-6.531677909	-6.145096821	0.15123584130154924	0.26427034751325845
7	-0.620207168	-0.587839697	-6.531310232	-6.13821752	0.15981917557030295	0.27459360715001824
8	-0.621007702	-0.585491645	-6.528861949	-6.133565901	0.16749822227117062	0.25330628437548874


////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////
9.9
相比custom_dataset_config的改进：
更大模型 - E512_10_D256_1 vs E256_10_D128_1
更高学习率 - 5e-4 vs 1e-4，收敛更快
损失下降更快 - 前几个batch就显示明显改善
预期结果：
这个配置应该能获得比原始custom_dataset_config更好的性能
更大的模型容量 + 更高的学习率 = 更好的收敛

结果：
在E:\Waveformer-main\experiments\dcc_tf_ckpt_E512_10_D256_1这里面。



